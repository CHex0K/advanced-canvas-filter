/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MyPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
function isCanvasGroupData(node) {
  return (node == null ? void 0 : node.type) === "group";
}
function nodeBondingBoxContains(outerNode, innerNode) {
  return outerNode.x <= innerNode.x && outerNode.x + outerNode.width >= innerNode.x + innerNode.width && outerNode.y <= innerNode.y && outerNode.y + outerNode.height >= innerNode.y + innerNode.height;
}
function showOnlyNodes(canvas, opacity, idsToShow) {
  const nodes = canvas.nodes.values();
  for (const node of nodes) {
    if (idsToShow === void 0 || idsToShow.has(node.id)) {
      node.nodeEl.style.opacity = "";
    } else {
      node.nodeEl.style.opacity = opacity;
    }
  }
}
function showOnlyEdges(canvas, opacity, idsToShow) {
  const edges = canvas.edges.values();
  for (const edge of edges) {
    if (idsToShow === void 0 || idsToShow.has(edge.id)) {
      edge.lineGroupEl.style.opacity = "";
      edge.lineEndGroupEl.style.opacity = "";
    } else {
      edge.lineGroupEl.style.opacity = opacity;
      edge.lineEndGroupEl.style.opacity = opacity;
    }
  }
}
function getGroupsFor(allNodes, nonGroupNodes) {
  return allNodes.filter((x) => isCanvasGroupData(x) && nonGroupNodes.some((fn) => nodeBondingBoxContains(x, fn)));
}
function getEdgesWhereBothNodesInSet(allEdges, nodeIds) {
  return allEdges.filter((edge) => nodeIds.has(edge.fromNode) && nodeIds.has(edge.toNode));
}
function addUndefinedGroup(groupsDictionary, newArray) {
  const newGroupsDictionary = { ...groupsDictionary };
  if (newGroupsDictionary.hasOwnProperty("Other tags")) {
    delete newGroupsDictionary["Other tags"];
  }
  const undefinedGroup = newArray.filter((tag) => {
    for (const group in newGroupsDictionary) {
      if (newGroupsDictionary[group].includes(tag)) {
        return false;
      }
    }
    return true;
  });
  newGroupsDictionary["Other tags"] = undefinedGroup;
  return newGroupsDictionary;
}
function filterNodes(canvasData, tagsToShow, mode) {
  return canvasData.nodes.filter((node) => {
    var _a, _b;
    if (mode === "Any Tag Inclusion") {
      if (node.type === "file") {
        const metadata = this.app.metadataCache.getCache(node.file);
        return (_a = metadata == null ? void 0 : metadata.tags) == null ? void 0 : _a.some((x) => tagsToShow.includes(x.tag));
      } else if (node.type === "text") {
        return tagsToShow.some((t) => node.text.includes(t));
      } else {
        return false;
      }
    } else if (mode === "All Tags Inclusion") {
      if (node.type === "file") {
        const metadata = this.app.metadataCache.getCache(node.file);
        const nodeTags = (_b = metadata == null ? void 0 : metadata.tags) == null ? void 0 : _b.map((tag) => tag.tag);
        if (!nodeTags)
          return false;
        return tagsToShow.every((t) => nodeTags.includes(t));
      } else if (node.type === "text") {
        return tagsToShow.every((t) => node.text.includes(t));
      } else {
        return false;
      }
    } else {
      console.error("Invalid mode: " + mode);
      return false;
    }
  });
}
var DEFAULT_SETTINGS = {
  mySetting: "default",
  checkboxGroups: { "Group 1": ["#tag1", "#tag2", "#tag3"], "Group 2": ["#tag4", "#tag5", "#tag6"] },
  checkboxStates: {},
  jsonInput: '{"exampe group": ["#example_tag"]}',
  addOtherTagsGroup: false,
  HidenOpacity: "0.5",
  FilterMode: "All Tags Inclusion"
};
var MyPlugin = class extends import_obsidian.Plugin {
  constructor() {
    super(...arguments);
    this.onActiveLeafChange = async () => {
      const activeLeaf = this.app.workspace.activeLeaf;
      if (!activeLeaf)
        return;
      const activeView = activeLeaf.view;
      if (!activeView)
        return;
      if (activeView.getViewType() === "canvas") {
        let s = this.getActiveCheckboxes();
        this.showNodesByTags(s);
      }
    };
    this.ifActiveViewIsCanvas = (commandFn) => (checking) => {
      const canvasView = this.app.workspace.getActiveViewOfType(import_obsidian.ItemView);
      if ((canvasView == null ? void 0 : canvasView.getViewType()) !== "canvas") {
        if (checking) {
          return false;
        }
        return;
      }
      if (checking) {
        return true;
      }
      const canvas = canvasView.canvas;
      if (!canvas) {
        return;
      }
      ;
      const canvasData = canvas.getData();
      if (!canvasData) {
        return;
      }
      ;
      return commandFn(canvas, canvasData);
    };
  }
  async onload() {
    await this.loadSettings();
    this.registerEvent(this.app.workspace.on("active-leaf-change", this.onActiveLeafChange));
    const ribbonIconEl = this.addRibbonIcon("filter", "Advanced Canvas Filter", (evt) => {
      new SampleModal(this.app, this.settings, this.saveSettings.bind(this), this.getActiveCheckboxes.bind(this), this).open();
    });
    ribbonIconEl.addClass("my-plugin-ribbon-class");
    const statusBarItemEl = this.addStatusBarItem();
    statusBarItemEl.setText("Status Bar Text");
    this.addSettingTab(new SampleSettingTab(this.app, this));
    this.registerDomEvent(document, "click", (evt) => {
    });
    this.registerInterval(window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3));
  }
  async showNodesByTags(tagsToShow) {
    await this.ifActiveViewIsCanvas(async (canvas, canvasData) => {
      showOnlyNodes(canvas, this.settings.HidenOpacity);
      showOnlyEdges(canvas, this.settings.HidenOpacity);
      const nodesToShow = filterNodes(canvasData, tagsToShow, this.settings.FilterMode);
      const groupsToShow = getGroupsFor(canvasData.nodes, nodesToShow);
      const nodeIdsToShow = new Set(nodesToShow.map((x) => x.id));
      const edgesToShow = getEdgesWhereBothNodesInSet(canvasData.edges, nodeIdsToShow);
      for (const group of groupsToShow) {
        nodeIdsToShow.add(group.id);
      }
      showOnlyNodes(canvas, this.settings.HidenOpacity, nodeIdsToShow);
      showOnlyEdges(canvas, this.settings.HidenOpacity, new Set(edgesToShow.map((x) => x.id)));
      if (tagsToShow.length === 0) {
        console.log("tags not found");
        showOnlyNodes(canvas, this.settings.HidenOpacity);
        showOnlyEdges(canvas, this.settings.HidenOpacity);
      }
    })(false);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getActiveCheckboxes() {
    const activeCheckboxes = [];
    for (const name in this.settings.checkboxStates) {
      if (this.settings.checkboxStates.hasOwnProperty(name) && this.settings.checkboxStates[name]) {
        activeCheckboxes.push(name);
      }
    }
    return activeCheckboxes;
  }
};
var SampleModal = class extends import_obsidian.Modal {
  constructor(app, settings, saveSettingsFunc, getActiveCheckboxesFunc, outerApp) {
    super(app);
    this.settings = settings;
    this.saveSettingsFunc = saveSettingsFunc;
    this.getActiveCheckboxesFunc = getActiveCheckboxesFunc;
    this.outerApp = outerApp;
  }
  async onOpen() {
    const { contentEl } = this;
    this.checkboxGroupsContainer = contentEl.createEl("div");
    this.checkboxGroupsContainer.addClass("checkbox-groups-container");
    const jsonInputContainer = contentEl.createEl("div");
    jsonInputContainer.style.marginTop = "50px";
    jsonInputContainer.createEl("h3", { text: "Json structure" });
    jsonInputContainer.addClass("json-input-container");
    const jsonInput = jsonInputContainer.createEl("textarea", { attr: { rows: "1" } });
    jsonInput.value = this.settings.jsonInput;
    jsonInput.placeholder = "Enter JSON for checkbox groups";
    const saveButton = contentEl.createEl("button");
    saveButton.addClass("mod-cta");
    saveButton.setText("Refresh groups");
    saveButton.onclick = () => {
      try {
        this.checkboxGroupsContainer.empty();
        const jsonData = JSON.parse(jsonInput.value);
        this.settings.checkboxGroups = jsonData;
        this.settings.jsonInput = jsonInput.value;
        this.saveSettingsFunc();
        new import_obsidian.Notice("JSON saved successfully");
        console.log("SAVE");
        this.refreshCheckboxGroups();
      } catch (error) {
        new import_obsidian.Notice("Error parsing JSON");
        console.error(error);
      }
    };
    const resetButton = contentEl.createEl("button");
    resetButton.addClass("mod-cta");
    resetButton.setText("Reset");
    resetButton.style.position = "absolute";
    resetButton.style.bottom = "10px";
    resetButton.style.right = "10px";
    resetButton.style.backgroundColor = "red";
    resetButton.style.transition = "background-color 0.3s ease";
    resetButton.onmouseenter = () => {
      resetButton.style.backgroundColor = "#ff6666";
    };
    resetButton.onmouseleave = () => {
      resetButton.style.backgroundColor = "red";
    };
    resetButton.onclick = () => {
      this.settings.checkboxStates = {};
      const checkboxes = document.querySelectorAll('input[type="checkbox"]');
      checkboxes.forEach((checkbox) => {
        if (checkbox instanceof HTMLInputElement) {
          checkbox.checked = false;
        }
      });
    };
    contentEl.appendChild(resetButton);
    this.refreshCheckboxGroups();
  }
  refreshCheckboxGroups() {
    if (!this.checkboxGroupsContainer)
      return;
    if (this.settings.addOtherTagsGroup) {
      this.settings.checkboxGroups = addUndefinedGroup(this.settings.checkboxGroups, this.getUniqueTags());
    } else {
      if (this.settings.checkboxGroups.hasOwnProperty("Other tags")) {
        delete this.settings.checkboxGroups["Other tags"];
      }
    }
    Object.keys(this.settings.checkboxGroups).forEach((groupName) => {
      const groupContainer = this.checkboxGroupsContainer.createEl("div");
      groupContainer.createEl("h3", { text: groupName });
      this.settings.checkboxGroups[groupName].forEach((tag) => this.createCheckbox(groupContainer, tag));
    });
  }
  createCheckbox(container, name) {
    var _a;
    const checkbox = container.createEl("label");
    checkbox.setText(name);
    const checkboxInput = checkbox.createEl("input");
    checkboxInput.setAttribute("type", "checkbox");
    checkboxInput.checked = (_a = this.settings.checkboxStates[name]) != null ? _a : false;
    checkboxInput.onchange = () => {
      this.settings.checkboxStates[name] = checkboxInput.checked;
      this.saveSettingsFunc();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    let s = this.getActiveCheckboxesFunc();
    this.outerApp.showNodesByTags(s);
  }
  getUniqueTags() {
    const canvasView = this.app.workspace.getActiveViewOfType(import_obsidian.ItemView);
    if ((canvasView == null ? void 0 : canvasView.getViewType()) !== "canvas") {
      return [];
    }
    const canvasData = canvasView.canvas.getData();
    if (!canvasData) {
      return [];
    }
    const tags = /* @__PURE__ */ new Set();
    canvasData.nodes.forEach((node) => {
      if (node.type === "text") {
        const textTags = node.text.match(/#[^\s]+/g);
        if (textTags) {
          textTags.forEach((tag) => tags.add(tag));
        }
      } else if (node.type === "file") {
        const metadata = this.app.metadataCache.getCache(node.file);
        if (metadata && metadata.tags) {
          metadata.tags.forEach((tag) => tags.add(tag.tag));
        }
      }
    });
    return Array.from(tags);
  }
};
var SampleSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName('Add "Other tags" group').setDesc('Check this box to add an "Other tags" group.').addToggle((toggle) => toggle.setValue(this.plugin.settings.addOtherTagsGroup).onChange(async (value) => {
      this.plugin.settings.addOtherTagsGroup = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Hidden Opacity").setDesc("Adjust the opacity level for hidden elements. Value must been between 0 and 1").addText((text) => text.setValue(this.plugin.settings.HidenOpacity).onChange(async (value) => {
      const parsedValue = parseFloat(value);
      const newValue = Math.max(0, Math.min(parsedValue, 1));
      this.plugin.settings.HidenOpacity = newValue.toString();
      await this.plugin.saveSettings();
    }).setPlaceholder("between 0 and 1"));
    new import_obsidian.Setting(containerEl).setName("Filter mode").setDesc('"Any Tag Inclusion" means that nodes will be shown if they contain at least one of the selected tags. "All Tags Inclusion" means that nodes will only be shown if they contain all of the selected tags.').addDropdown((dropdown) => dropdown.addOption("All Tags Inclusion", "All Tags Inclusion").addOption("Any Tag Inclusion", "Any Tag Inclusion").setValue(this.plugin.settings.FilterMode).onChange(async (value) => {
      this.plugin.settings.FilterMode = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQ2FudmFzRGF0YSwgQ2FudmFzRWRnZURhdGEsIENhbnZhc0ZpbGVEYXRhLCBDYW52YXNMaW5rRGF0YSwgQ2FudmFzTm9kZURhdGEsIENhbnZhc1RleHREYXRhIH0gZnJvbSAnb2JzaWRpYW4vY2FudmFzJztcclxuaW1wb3J0IHsgQXBwLCBGdXp6eVN1Z2dlc3RNb2RhbCwgZ2V0QWxsVGFncywgSXRlbVZpZXcsIE5vdGljZSwgUGx1Z2luLCBNb2RhbCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcclxuLy9pbXBvcnQgeyBBcHAsIEVkaXRvciwgTWFya2Rvd25WaWV3LCBNb2RhbCwgTm90aWNlLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENhbnZhc0dyb3VwRGF0YSBleHRlbmRzIENhbnZhc05vZGVEYXRhIHtcclxuXHR0eXBlOiAnZ3JvdXAnLFxyXG5cdGxhYmVsOiBzdHJpbmdcclxufVxyXG5cclxuZnVuY3Rpb24gaXNDYW52YXNHcm91cERhdGEobm9kZTogQ2FudmFzTm9kZURhdGEpOiBub2RlIGlzIENhbnZhc0dyb3VwRGF0YSB7XHJcblx0cmV0dXJuIChub2RlIGFzIGFueSk/LnR5cGUgPT09ICdncm91cCc7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG5vZGVCb25kaW5nQm94Q29udGFpbnMob3V0ZXJOb2RlOiBDYW52YXNOb2RlRGF0YSwgaW5uZXJOb2RlOiBDYW52YXNOb2RlRGF0YSkge1xyXG5cdHJldHVybiBvdXRlck5vZGUueCA8PSBpbm5lck5vZGUueFxyXG5cdFx0JiYgKG91dGVyTm9kZS54ICsgb3V0ZXJOb2RlLndpZHRoKSA+PSAoaW5uZXJOb2RlLnggKyBpbm5lck5vZGUud2lkdGgpXHJcblx0XHQmJiBvdXRlck5vZGUueSA8PSBpbm5lck5vZGUueVxyXG5cdFx0JiYgKG91dGVyTm9kZS55ICsgb3V0ZXJOb2RlLmhlaWdodCkgPj0gKGlubmVyTm9kZS55ICsgaW5uZXJOb2RlLmhlaWdodCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNob3dPbmx5Tm9kZXMoY2FudmFzOiBhbnksIG9wYWNpdHk6IHN0cmluZywgaWRzVG9TaG93PzogU2V0PHN0cmluZz4pIHtcclxuICAgIGNvbnN0IG5vZGVzID0gY2FudmFzLm5vZGVzLnZhbHVlcygpO1xyXG5cclxuICAgIGZvciAoY29uc3Qgbm9kZSBvZiBub2Rlcykge1xyXG4gICAgICAgIGlmIChpZHNUb1Nob3cgPT09IHVuZGVmaW5lZCB8fCBpZHNUb1Nob3cuaGFzKG5vZGUuaWQpKSB7XHJcbiAgICAgICAgICAgIG5vZGUubm9kZUVsLnN0eWxlLm9wYWNpdHkgPSBcIlwiOyAvLyBcdTA0MjFcdTA0MzFcdTA0NDBcdTA0MzBcdTA0NDFcdTA0NEJcdTA0MzJcdTA0MzBcdTA0MzVcdTA0M0Mgb3BhY2l0eVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIG5vZGUubm9kZUVsLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5OyAvLyBcdTA0MTRcdTA0MzVcdTA0M0JcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDREXHUwNDNCXHUwNDM1XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDQyIFx1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0M1x1MDQzRlx1MDQ0MFx1MDQzRVx1MDQzN1x1MDQ0MFx1MDQzMFx1MDQ0N1x1MDQzRFx1MDQ0Qlx1MDQzQ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gc2hvd09ubHlFZGdlcyhjYW52YXM6IGFueSwgb3BhY2l0eTogc3RyaW5nLCBpZHNUb1Nob3c/OiBTZXQ8c3RyaW5nPikge1xyXG4gICAgY29uc3QgZWRnZXMgPSBjYW52YXMuZWRnZXMudmFsdWVzKCk7XHJcblxyXG4gICAgZm9yIChjb25zdCBlZGdlIG9mIGVkZ2VzKSB7XHJcbiAgICAgICAgaWYgKGlkc1RvU2hvdyA9PT0gdW5kZWZpbmVkIHx8IGlkc1RvU2hvdy5oYXMoZWRnZS5pZCkpIHtcclxuICAgICAgICAgICAgZWRnZS5saW5lR3JvdXBFbC5zdHlsZS5vcGFjaXR5ID0gXCJcIjsgLy8gXHUwNDIxXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDQxXHUwNDRCXHUwNDMyXHUwNDMwXHUwNDM1XHUwNDNDIG9wYWNpdHlcclxuICAgICAgICAgICAgZWRnZS5saW5lRW5kR3JvdXBFbC5zdHlsZS5vcGFjaXR5ID0gXCJcIjsgLy8gXHUwNDIxXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDQxXHUwNDRCXHUwNDMyXHUwNDMwXHUwNDM1XHUwNDNDIG9wYWNpdHlcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBlZGdlLmxpbmVHcm91cEVsLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5OyAvLyBcdTA0MTRcdTA0MzVcdTA0M0JcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDREXHUwNDNCXHUwNDM1XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDQyIFx1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0M1x1MDQzRlx1MDQ0MFx1MDQzRVx1MDQzN1x1MDQ0MFx1MDQzMFx1MDQ0N1x1MDQzRFx1MDQ0Qlx1MDQzQ1xyXG4gICAgICAgICAgICBlZGdlLmxpbmVFbmRHcm91cEVsLnN0eWxlLm9wYWNpdHkgPSBvcGFjaXR5OyAvLyBcdTA0MTRcdTA0MzVcdTA0M0JcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDREXHUwNDNCXHUwNDM1XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDQyIFx1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0M1x1MDQzRlx1MDQ0MFx1MDQzRVx1MDQzN1x1MDQ0MFx1MDQzMFx1MDQ0N1x1MDQzRFx1MDQ0Qlx1MDQzQ1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0R3JvdXBzRm9yKGFsbE5vZGVzOiBDYW52YXNOb2RlRGF0YVtdLCBub25Hcm91cE5vZGVzOiBDYW52YXNOb2RlRGF0YVtdKSB7XHJcblx0cmV0dXJuIGFsbE5vZGVzLmZpbHRlcih4ID0+IGlzQ2FudmFzR3JvdXBEYXRhKHgpXHJcblx0XHQmJiBub25Hcm91cE5vZGVzLnNvbWUoZm4gPT4gbm9kZUJvbmRpbmdCb3hDb250YWlucyh4LCBmbikpKTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0RWRnZXNXaGVyZUJvdGhOb2Rlc0luU2V0KGFsbEVkZ2VzOiBDYW52YXNFZGdlRGF0YVtdLCBub2RlSWRzOiBTZXQ8c3RyaW5nPikge1xyXG5cdHJldHVybiBhbGxFZGdlc1xyXG5cdFx0LmZpbHRlcihlZGdlID0+IG5vZGVJZHMuaGFzKGVkZ2UuZnJvbU5vZGUpXHJcblx0XHRcdCYmIG5vZGVJZHMuaGFzKGVkZ2UudG9Ob2RlKSk7XHJcbn1cclxuXHJcbi8vXHUwNDM0XHUwNDNFXHUwNDMxXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQzMiBcdTA0NDFcdTA0M0JcdTA0M0VcdTA0MzJcdTA0MzBcdTA0NDBcdTA0NEMgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGXHUwNDRCIFx1MDQ0Mlx1MDQzNVx1MDQzM1x1MDQzRVx1MDQzMiwgXHUwNDNBXHUwNDNFXHUwNDQyXHUwNDNFXHUwNDQwXHUwNDRCXHUwNDM1IFx1MDQzRFx1MDQzNSBcdTA0MzJcdTA0M0VcdTA0NDhcdTA0M0JcdTA0MzggXHUwNDMyIFx1MDQzNFx1MDQ0MFx1MDQ0M1x1MDQzM1x1MDQzOFx1MDQzNSBcdTA0MzNcdTA0NDBcdTA0NDNcdTA0M0ZcdTA0M0ZcdTA0NEJcclxuZnVuY3Rpb24gYWRkVW5kZWZpbmVkR3JvdXAoZ3JvdXBzRGljdGlvbmFyeTogeyBba2V5OiBzdHJpbmddOiBzdHJpbmdbXSB9LCBuZXdBcnJheTogc3RyaW5nW10pOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZ1tdIH0ge1xyXG4gICAgLy8gXHUwNDIxXHUwNDNFXHUwNDM3XHUwNDM0XHUwNDMwXHUwNDM1XHUwNDNDIFx1MDQzQVx1MDQzRVx1MDQzRlx1MDQzOFx1MDQ0RSBcdTA0NDFcdTA0M0JcdTA0M0VcdTA0MzJcdTA0MzBcdTA0NDBcdTA0NEYsIFx1MDQ0N1x1MDQ0Mlx1MDQzRVx1MDQzMVx1MDQ0QiBcdTA0M0RcdTA0MzUgXHUwNDM4XHUwNDM3XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDRGXHUwNDQyXHUwNDRDIFx1MDQzOFx1MDQ0MVx1MDQ0NVx1MDQzRVx1MDQzNFx1MDQzRFx1MDQ0Qlx1MDQzOVxyXG4gICAgY29uc3QgbmV3R3JvdXBzRGljdGlvbmFyeSA9IHsgLi4uZ3JvdXBzRGljdGlvbmFyeSB9O1xyXG5cclxuICAgIC8vIFx1MDQxRlx1MDQ0MFx1MDQzRVx1MDQzMlx1MDQzNVx1MDQ0MFx1MDQ0Rlx1MDQzNVx1MDQzQywgXHUwNDQxXHUwNDQzXHUwNDQ5XHUwNDM1XHUwNDQxXHUwNDQyXHUwNDMyXHUwNDQzXHUwNDM1XHUwNDQyIFx1MDQzQlx1MDQzOCBcdTA0NDNcdTA0MzZcdTA0MzUgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGXHUwNDMwIFwidW5kZWZpbmVkXCJcclxuICAgIGlmIChuZXdHcm91cHNEaWN0aW9uYXJ5Lmhhc093blByb3BlcnR5KFwiT3RoZXIgdGFnc1wiKSkge1xyXG4gICAgICAgIC8vIFx1MDQyM1x1MDQzNFx1MDQzMFx1MDQzQlx1MDQ0Rlx1MDQzNVx1MDQzQyBcInVuZGVmaW5lZFwiIFx1MDQzOFx1MDQzNyBcdTA0NDFcdTA0M0ZcdTA0MzhcdTA0NDFcdTA0M0FcdTA0MzAgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGIFx1MDQzNFx1MDQzQlx1MDQ0RiBcdTA0MzhcdTA0NDJcdTA0MzVcdTA0NDBcdTA0MzBcdTA0NDZcdTA0MzhcdTA0MzhcclxuICAgICAgICBkZWxldGUgbmV3R3JvdXBzRGljdGlvbmFyeVtcIk90aGVyIHRhZ3NcIl07XHJcbiAgICBcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTA0MjFcdTA0M0VcdTA0MzdcdTA0MzRcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDNEXHUwNDNFXHUwNDMyXHUwNDQzXHUwNDRFIFx1MDQzM1x1MDQ0MFx1MDQ0M1x1MDQzRlx1MDQzRlx1MDQ0M1xyXG4gICAgY29uc3QgdW5kZWZpbmVkR3JvdXA6IHN0cmluZ1tdID0gbmV3QXJyYXkuZmlsdGVyKHRhZyA9PiB7XHJcbiAgICAgICAgLy8gXHUwNDI0XHUwNDM4XHUwNDNCXHUwNDRDXHUwNDQyXHUwNDQwXHUwNDQzXHUwNDM1XHUwNDNDIFx1MDQ0Mlx1MDQzRVx1MDQzQlx1MDQ0Q1x1MDQzQVx1MDQzRSBcdTA0NDJcdTA0MzVcdTA0MzNcdTA0MzgsIFx1MDQzQVx1MDQzRVx1MDQ0Mlx1MDQzRVx1MDQ0MFx1MDQ0Qlx1MDQ0NSBcdTA0M0RcdTA0MzVcdTA0NDIgXHUwNDMyIFx1MDQ0MVx1MDQ0M1x1MDQ0OVx1MDQzNVx1MDQ0MVx1MDQ0Mlx1MDQzMlx1MDQ0M1x1MDQ0RVx1MDQ0OVx1MDQzOFx1MDQ0NSBcdTA0MzNcdTA0NDBcdTA0NDNcdTA0M0ZcdTA0M0ZcdTA0MzBcdTA0NDVcclxuICAgICAgICBmb3IgKGNvbnN0IGdyb3VwIGluIG5ld0dyb3Vwc0RpY3Rpb25hcnkpIHtcclxuICAgICAgICAgICAgaWYgKG5ld0dyb3Vwc0RpY3Rpb25hcnlbZ3JvdXBdLmluY2x1ZGVzKHRhZykpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gXHUwNDIyXHUwNDM1XHUwNDMzIFx1MDQ0M1x1MDQzNlx1MDQzNSBcdTA0MzVcdTA0NDFcdTA0NDJcdTA0NEMgXHUwNDMyIFx1MDQzQVx1MDQzMFx1MDQzQVx1MDQzRVx1MDQzOS1cdTA0NDJcdTA0M0UgXHUwNDM4XHUwNDM3IFx1MDQzM1x1MDQ0MFx1MDQ0M1x1MDQzRlx1MDQzRlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlOyAvLyBcdTA0MjJcdTA0MzVcdTA0MzNcdTA0MzAgXHUwNDNEXHUwNDM1XHUwNDQyIFx1MDQzRFx1MDQzOCBcdTA0MzIgXHUwNDNFXHUwNDM0XHUwNDNEXHUwNDNFXHUwNDM5IFx1MDQzOFx1MDQzNyBcdTA0NDFcdTA0NDNcdTA0NDlcdTA0MzVcdTA0NDFcdTA0NDJcdTA0MzJcdTA0NDNcdTA0NEVcdTA0NDlcdTA0MzhcdTA0NDUgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBcdTA0MTRcdTA0M0VcdTA0MzFcdTA0MzBcdTA0MzJcdTA0M0JcdTA0NEZcdTA0MzVcdTA0M0MgXHUwNDNEXHUwNDNFXHUwNDMyXHUwNDQzXHUwNDRFIFx1MDQzM1x1MDQ0MFx1MDQ0M1x1MDQzRlx1MDQzRlx1MDQ0MyBcdTA0MzIgXHUwNDQxXHUwNDNCXHUwNDNFXHUwNDMyXHUwNDMwXHUwNDQwXHUwNDRDXHJcbiAgICBuZXdHcm91cHNEaWN0aW9uYXJ5W1wiT3RoZXIgdGFnc1wiXSA9IHVuZGVmaW5lZEdyb3VwO1xyXG5cclxuICAgIHJldHVybiBuZXdHcm91cHNEaWN0aW9uYXJ5O1xyXG59XHJcbi8vXHUwNDQ0XHUwNDQzXHUwNDNEXHUwNDQ2XHUwNDM4XHUwNDRGIFx1MDQzMlx1MDQ0Qlx1MDQzMVx1MDQzOFx1MDQ0MFx1MDQzMFx1MDQ0RVx1MDQ0OVx1MDQzMFx1MDQ0RiBcdTA0M0RcdTA0M0VcdTA0MzRcdTA0NEIgXHUwNDM0XHUwNDNCXHUwNDRGIFx1MDQzRlx1MDQzRVx1MDQzQVx1MDQzMFx1MDQzN1x1MDQzMFxyXG5mdW5jdGlvbiBmaWx0ZXJOb2RlcyhjYW52YXNEYXRhOiBhbnksIHRhZ3NUb1Nob3c6IHN0cmluZ1tdLCBtb2RlOiBzdHJpbmcpOiBhbnlbXSB7XHJcbiAgICAvL2lmICh0YWdzVG9TaG93Lmxlbmd0aCA9PT0gMClcclxuICAgIFxyXG4gICAgcmV0dXJuIGNhbnZhc0RhdGEubm9kZXMuZmlsdGVyKChub2RlOiBhbnkpID0+IHtcclxuICAgICAgICBpZiAobW9kZSA9PT0gXCJBbnkgVGFnIEluY2x1c2lvblwiKSB7XHJcbiAgICAgICAgICAgIC8vIFx1MDQyMFx1MDQzNVx1MDQzNlx1MDQzOFx1MDQzQyAxOiBcdTA0MUZcdTA0NDBcdTA0M0VcdTA0MzJcdTA0MzVcdTA0NDBcdTA0NEZcdTA0MzVcdTA0M0MsIFx1MDQ0MVx1MDQzRVx1MDQzNFx1MDQzNVx1MDQ0MFx1MDQzNlx1MDQzOFx1MDQ0MiBcdTA0M0JcdTA0MzggXHUwNDQyXHUwNDM1XHUwNDNBXHUwNDQzXHUwNDQ5XHUwNDM4XHUwNDM5IFx1MDQ0RFx1MDQzQlx1MDQzNVx1MDQzQ1x1MDQzNVx1MDQzRFx1MDQ0MiBcdTA0NDVcdTA0M0VcdTA0NDJcdTA0NEYgXHUwNDMxXHUwNDRCIFx1MDQzRVx1MDQzNFx1MDQzOFx1MDQzRCBcdTA0MzhcdTA0MzcgXHUwNDMyXHUwNDRCXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDNEXHUwNDNEXHUwNDRCXHUwNDQ1IFx1MDQ0Mlx1MDQzNVx1MDQzM1x1MDQzRVx1MDQzMlxyXG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSBcImZpbGVcIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbWV0YWRhdGEgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKG5vZGUuZmlsZSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbWV0YWRhdGE/LnRhZ3M/LnNvbWUoKHg6IGFueSkgPT4gdGFnc1RvU2hvdy5pbmNsdWRlcyh4LnRhZykpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gXCJ0ZXh0XCIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzVG9TaG93LnNvbWUoKHQ6IHN0cmluZykgPT4gKG5vZGUgYXMgYW55KS50ZXh0LmluY2x1ZGVzKHQpKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsgLy8gXHUwNDE1XHUwNDQxXHUwNDNCXHUwNDM4IFx1MDQ0M1x1MDQzN1x1MDQzNVx1MDQzQiBcdTA0M0RcdTA0MzUgXHUwNDRGXHUwNDMyXHUwNDNCXHUwNDRGXHUwNDM1XHUwNDQyXHUwNDQxXHUwNDRGIFx1MDQ0NFx1MDQzMFx1MDQzOVx1MDQzQlx1MDQzRVx1MDQzQyBcdTA0MzhcdTA0M0JcdTA0MzggXHUwNDQyXHUwNDM1XHUwNDNBXHUwNDQxXHUwNDQyXHUwNDNFXHUwNDNDLCBcdTA0M0RcdTA0MzUgXHUwNDQzXHUwNDM0XHUwNDNFXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDQyXHUwNDMyXHUwNDNFXHUwNDQwXHUwNDRGXHUwNDM1XHUwNDQyIFx1MDQ0M1x1MDQ0MVx1MDQzQlx1MDQzRVx1MDQzMlx1MDQzOFx1MDQ0RVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChtb2RlID09PSBcIkFsbCBUYWdzIEluY2x1c2lvblwiKSB7XHJcbiAgICAgICAgICAgIC8vIFx1MDQyMFx1MDQzNVx1MDQzNlx1MDQzOFx1MDQzQyAyOiBcdTA0MUZcdTA0NDBcdTA0M0VcdTA0MzJcdTA0MzVcdTA0NDBcdTA0NEZcdTA0MzVcdTA0M0MsIFx1MDQ0MVx1MDQzRVx1MDQzNFx1MDQzNVx1MDQ0MFx1MDQzNlx1MDQzOFx1MDQ0MiBcdTA0M0JcdTA0MzggXHUwNDQyXHUwNDM1XHUwNDNBXHUwNDQxXHUwNDQyIFx1MDQ0M1x1MDQzN1x1MDQzQlx1MDQzMCBcdTA0MTJcdTA0MjFcdTA0MTUgXHUwNDQyXHUwNDM1XHUwNDMzXHUwNDM4IFx1MDQzOFx1MDQzNyBcdTA0NDFcdTA0M0ZcdTA0MzhcdTA0NDFcdTA0M0FcdTA0MzBcclxuICAgICAgICAgICAgaWYgKG5vZGUudHlwZSA9PT0gXCJmaWxlXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZShub2RlLmZpbGUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgbm9kZVRhZ3MgPSBtZXRhZGF0YT8udGFncz8ubWFwKCh0YWc6IHsgdGFnOiBzdHJpbmcgfSkgPT4gdGFnLnRhZyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIW5vZGVUYWdzKSByZXR1cm4gZmFsc2U7IC8vIFx1MDQxNVx1MDQ0MVx1MDQzQlx1MDQzOCBcdTA0M0RcdTA0MzVcdTA0NDIgXHUwNDQyXHUwNDM1XHUwNDMzXHUwNDNFXHUwNDMyIFx1MDQ0MyBcdTA0NDRcdTA0MzBcdTA0MzlcdTA0M0JcdTA0MzAsIFx1MDQ0MVx1MDQ0MFx1MDQzMFx1MDQzN1x1MDQ0MyBcdTA0MzJcdTA0M0VcdTA0MzdcdTA0MzJcdTA0NDBcdTA0MzBcdTA0NDlcdTA0MzBcdTA0MzVcdTA0M0MgZmFsc2VcclxuICAgICAgICAgICAgICAgIHJldHVybiB0YWdzVG9TaG93LmV2ZXJ5KCh0OiBzdHJpbmcpID0+IG5vZGVUYWdzLmluY2x1ZGVzKHQpKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChub2RlLnR5cGUgPT09IFwidGV4dFwiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGFnc1RvU2hvdy5ldmVyeSgodDogc3RyaW5nKSA9PiAobm9kZSBhcyBhbnkpLnRleHQuaW5jbHVkZXModCkpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyBcdTA0MTVcdTA0NDFcdTA0M0JcdTA0MzggXHUwNDQzXHUwNDM3XHUwNDM1XHUwNDNCIFx1MDQzRFx1MDQzNSBcdTA0NEZcdTA0MzJcdTA0M0JcdTA0NEZcdTA0MzVcdTA0NDJcdTA0NDFcdTA0NEYgXHUwNDQ0XHUwNDMwXHUwNDM5XHUwNDNCXHUwNDNFXHUwNDNDIFx1MDQzOFx1MDQzQlx1MDQzOCBcdTA0NDJcdTA0MzVcdTA0M0FcdTA0NDFcdTA0NDJcdTA0M0VcdTA0M0MsIFx1MDQzRFx1MDQzNSBcdTA0NDNcdTA0MzRcdTA0M0VcdTA0MzJcdTA0M0JcdTA0MzVcdTA0NDJcdTA0MzJcdTA0M0VcdTA0NDBcdTA0NEZcdTA0MzVcdTA0NDIgXHUwNDQzXHUwNDQxXHUwNDNCXHUwNDNFXHUwNDMyXHUwNDM4XHUwNDRFXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBcdTA0MURcdTA0MzVcdTA0M0FcdTA0M0VcdTA0NDBcdTA0NDBcdTA0MzVcdTA0M0FcdTA0NDJcdTA0M0RcdTA0NEJcdTA0MzkgXHUwNDQwXHUwNDM1XHUwNDM2XHUwNDM4XHUwNDNDXHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJJbnZhbGlkIG1vZGU6IFwiICsgbW9kZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufVxyXG5cclxuXHJcbmludGVyZmFjZSBNeVBsdWdpblNldHRpbmdzIHtcclxuICAgIG15U2V0dGluZzogc3RyaW5nO1xyXG4gICAgY2hlY2tib3hHcm91cHM6IHsgW2tleTogc3RyaW5nXSA6IHN0cmluZ1tdfTtcclxuICAgIGNoZWNrYm94U3RhdGVzOiB7IFtuYW1lOiBzdHJpbmddOiBib29sZWFuIH07XHJcbiAgICBqc29uSW5wdXQ6IHN0cmluZztcclxuICAgIC8vXHUwNDM0XHUwNDNFXHUwNDMxXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDRGXHUwNDQyXHUwNDRDIFx1MDQzQlx1MDQzOCBcdTA0M0RcdTA0M0VcdTA0MzJcdTA0NDNcdTA0NEUgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGXHUwNDQzIFx1MDQzRFx1MDQzNVx1MDQzRFx1MDQzMFx1MDQzOVx1MDQzNFx1MDQzNVx1MDQzRFx1MDQzRFx1MDQ0Qlx1MDQ0NSBcdTA0NDJcdTA0MzVcdTA0MzNcdTA0M0VcdTA0MzJcclxuICAgIGFkZE90aGVyVGFnc0dyb3VwIDogYm9vbGVhbjtcclxuICAgIC8vXHUwNDNGXHUwNDQwXHUwNDNFXHUwNDM3XHUwNDQwXHUwNDMwXHUwNDQ3XHUwNDNEXHUwNDNFXHUwNDQxXHUwNDQyXHUwNDRDIFx1MDQ0MVx1MDQzQVx1MDQ0MFx1MDQ0Qlx1MDQ0Mlx1MDQ0Qlx1MDQ0NSBcdTA0NERcdTA0M0JcdTA0MzVcdTA0M0NcdTA0MzVcdTA0M0RcdTA0NDJcdTA0M0VcdTA0MzJcclxuICAgIEhpZGVuT3BhY2l0eTogc3RyaW5nO1xyXG4gICAgLy9cdTA0MzJcdTA0NEJcdTA0MzFcdTA0M0VcdTA0NDAgXHUwNDQwXHUwNDM1XHUwNDM2XHUwNDM4XHUwNDNDXHUwNDMwIFx1MDQ0NFx1MDQzOFx1MDQzQlx1MDQ0Q1x1MDQ0Mlx1MDQ0MFx1MDQzMFx1MDQ0Nlx1MDQzOFx1MDQzOFxyXG4gICAgRmlsdGVyTW9kZTogc3RyaW5nO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBNeVBsdWdpblNldHRpbmdzID0ge1xyXG4gICAgbXlTZXR0aW5nOiAnZGVmYXVsdCcsXHJcbiAgICBjaGVja2JveEdyb3Vwczoge1wiR3JvdXAgMVwiOiBbXCIjdGFnMVwiLCBcIiN0YWcyXCIsIFwiI3RhZzNcIl0sIFwiR3JvdXAgMlwiOiBbXCIjdGFnNFwiLCBcIiN0YWc1XCIsIFwiI3RhZzZcIl0gfSxcclxuICAgIGNoZWNrYm94U3RhdGVzOiB7fSxcclxuICAgIGpzb25JbnB1dDogJ3tcImV4YW1wZSBncm91cFwiOiBbXCIjZXhhbXBsZV90YWdcIl19JyxcclxuXHJcbiAgICBhZGRPdGhlclRhZ3NHcm91cCA6IGZhbHNlLFxyXG4gICAgSGlkZW5PcGFjaXR5OiBcIjAuNVwiLFxyXG4gICAgRmlsdGVyTW9kZTogXCJBbGwgVGFncyBJbmNsdXNpb25cIlxyXG59XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXlQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gICAgc2V0dGluZ3M6IE15UGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcbiAgICAgICAgdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgdGhpcy5vbkFjdGl2ZUxlYWZDaGFuZ2UpKTtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgLy8gVGhpcyBjcmVhdGVzIGFuIGljb24gaW4gdGhlIGxlZnQgcmliYm9uLlxyXG4gICAgICAgIGNvbnN0IHJpYmJvbkljb25FbCA9IHRoaXMuYWRkUmliYm9uSWNvbignZmlsdGVyJywgJ0FkdmFuY2VkIENhbnZhcyBGaWx0ZXInLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIC8vIENhbGxlZCB3aGVuIHRoZSB1c2VyIGNsaWNrcyB0aGUgaWNvbi5cclxuICAgICAgICAgICAgLy9jb25zdHJ1Y3RvcihhcHA6IEFwcCwgc2V0dGluZ3M6IE15UGx1Z2luU2V0dGluZ3MsIHNhdmVTZXR0aW5nc0Z1bmM6ICgpID0+IHZvaWQsIGdldEFjdGl2ZUNoZWNrYm94ZXNGdW5jOiAoKSA9PiBzdHJpbmdbXSwgb3V0ZXJBcHAgOiBNeVBsdWdpbikge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICAgICAgbmV3IFNhbXBsZU1vZGFsKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzLCB0aGlzLnNhdmVTZXR0aW5ncy5iaW5kKHRoaXMpLCB0aGlzLmdldEFjdGl2ZUNoZWNrYm94ZXMuYmluZCh0aGlzKSwgdGhpcykub3BlbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFBlcmZvcm0gYWRkaXRpb25hbCB0aGluZ3Mgd2l0aCB0aGUgcmliYm9uXHJcbiAgICAgICAgcmliYm9uSWNvbkVsLmFkZENsYXNzKCdteS1wbHVnaW4tcmliYm9uLWNsYXNzJyk7XHJcblxyXG4gICAgICAgIC8vIFRoaXMgYWRkcyBhIHN0YXR1cyBiYXIgaXRlbSB0byB0aGUgYm90dG9tIG9mIHRoZSBhcHAuIERvZXMgbm90IHdvcmsgb24gbW9iaWxlIGFwcHMuXHJcbiAgICAgICAgY29uc3Qgc3RhdHVzQmFySXRlbUVsID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XHJcbiAgICAgICAgc3RhdHVzQmFySXRlbUVsLnNldFRleHQoJ1N0YXR1cyBCYXIgVGV4dCcpO1xyXG5cclxuICAgICAgICAvLyBUaGlzIGFkZHMgYSBzZXR0aW5ncyB0YWIgc28gdGhlIHVzZXIgY2FuIGNvbmZpZ3VyZSB2YXJpb3VzIGFzcGVjdHMgb2YgdGhlIHBsdWdpblxyXG4gICAgICAgIHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgU2FtcGxlU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xyXG5cclxuICAgICAgICAvLyBJZiB0aGUgcGx1Z2luIGhvb2tzIHVwIGFueSBnbG9iYWwgRE9NIGV2ZW50cyAob24gcGFydHMgb2YgdGhlIGFwcCB0aGF0IGRvZXNuJ3QgYmVsb25nIHRvIHRoaXMgcGx1Z2luKVxyXG4gICAgICAgIC8vIFVzaW5nIHRoaXMgZnVuY3Rpb24gd2lsbCBhdXRvbWF0aWNhbGx5IHJlbW92ZSB0aGUgZXZlbnQgbGlzdGVuZXIgd2hlbiB0aGlzIHBsdWdpbiBpcyBkaXNhYmxlZC5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQsICdjbGljaycsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnY2xpY2snLCBldnQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBXaGVuIHJlZ2lzdGVyaW5nIGludGVydmFscywgdGhpcyBmdW5jdGlvbiB3aWxsIGF1dG9tYXRpY2FsbHkgY2xlYXIgdGhlIGludGVydmFsIHdoZW4gdGhlIHBsdWdpbiBpcyBkaXNhYmxlZC5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVySW50ZXJ2YWwod2luZG93LnNldEludGVydmFsKCgpID0+IGNvbnNvbGUubG9nKCdzZXRJbnRlcnZhbCcpLCA1ICogNjAgKiAxMDAwKSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHUwNDFFXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDMxXHUwNDNFXHUwNDQyXHUwNDQ3XHUwNDM4XHUwNDNBIFx1MDQ0MVx1MDQzRVx1MDQzMVx1MDQ0Qlx1MDQ0Mlx1MDQzOFx1MDQ0RiBcdTA0MzhcdTA0MzdcdTA0M0NcdTA0MzVcdTA0M0RcdTA0MzVcdTA0M0RcdTA0MzhcdTA0NEYgXHUwNDMwXHUwNDNBXHUwNDQyXHUwNDM4XHUwNDMyXHUwNDNEXHUwNDNFXHUwNDMzXHUwNDNFIFx1MDQzRlx1MDQ0MFx1MDQzNVx1MDQzNFx1MDQ0MVx1MDQ0Mlx1MDQzMFx1MDQzMlx1MDQzQlx1MDQzNVx1MDQzRFx1MDQzOFx1MDQ0RlxyXG4gICAgb25BY3RpdmVMZWFmQ2hhbmdlID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZUxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZjtcclxuICAgICAgICBpZiAoIWFjdGl2ZUxlYWYpIHJldHVybjsgLy8gXHUwNDE1XHUwNDQxXHUwNDNCXHUwNDM4IFx1MDQzRFx1MDQzNVx1MDQ0MiBcdTA0MzBcdTA0M0FcdTA0NDJcdTA0MzhcdTA0MzJcdTA0M0RcdTA0M0VcdTA0MzNcdTA0M0UgXHUwNDNGXHUwNDQwXHUwNDM1XHUwNDM0XHUwNDQxXHUwNDQyXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDRGLCBcdTA0MzJcdTA0NEJcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzhcdTA0M0NcclxuXHJcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IGFjdGl2ZUxlYWYudmlldztcclxuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHJldHVybjsgLy8gXHUwNDE1XHUwNDQxXHUwNDNCXHUwNDM4IFx1MDQzRFx1MDQzNVx1MDQ0MiBcdTA0MzBcdTA0M0FcdTA0NDJcdTA0MzhcdTA0MzJcdTA0M0RcdTA0M0VcdTA0MzNcdTA0M0UgXHUwNDNGXHUwNDQwXHUwNDM1XHUwNDM0XHUwNDQxXHUwNDQyXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDM1XHUwNDNEXHUwNDM4XHUwNDRGLCBcdTA0MzJcdTA0NEJcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzhcdTA0M0NcclxuXHJcbiAgICAgICAgLy8gXHUwNDFGXHUwNDQwXHUwNDNFXHUwNDMyXHUwNDM1XHUwNDQwXHUwNDRGXHUwNDM1XHUwNDNDLCBcdTA0NEZcdTA0MzJcdTA0M0JcdTA0NEZcdTA0MzVcdTA0NDJcdTA0NDFcdTA0NEYgXHUwNDNCXHUwNDM4IFx1MDQzMFx1MDQzQVx1MDQ0Mlx1MDQzOFx1MDQzMlx1MDQzRFx1MDQzRVx1MDQzNSBcdTA0M0ZcdTA0NDBcdTA0MzVcdTA0MzRcdTA0NDFcdTA0NDJcdTA0MzBcdTA0MzJcdTA0M0JcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDMyXHUwNDM4XHUwNDM0XHUwNDNFXHUwNDNDIFwiY2FudmFzXCJcclxuICAgICAgICBpZiAoYWN0aXZlVmlldy5nZXRWaWV3VHlwZSgpID09PSAnY2FudmFzJykge1xyXG4gICAgICAgICAgICAvL1x1MDQzRlx1MDQ0MFx1MDQzOCBcdTA0M0ZcdTA0MzVcdTA0NDBcdTA0MzVcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzUgXHUwNDNGXHUwNDNFXHUwNDNCXHUwNDRDXHUwNDM3XHUwNDNFXHUwNDMyXHUwNDMwXHUwNDQyXHUwNDM1XHUwNDNCXHUwNDRGIFx1MDQzRFx1MDQzMCBjYW52YXMgXHUwNDNGXHUwNDQwXHUwNDNFXHUwNDM4XHUwNDQxXHUwNDQ1XHUwNDNFXHUwNDM4XHUwNDQyIFx1MDQ0NFx1MDQzOFx1MDQzQlx1MDQ0Q1x1MDQ0Mlx1MDQ0MFx1MDQzRVx1MDQzMlx1MDQzQVx1MDQzMCBcdTA0M0ZcdTA0M0UgXHUwNDQyXHUwNDM1XHUwNDMzXHUwNDMwXHUwNDNDXHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ1VzZXIgc3dpdGNoZWQgdG8gY2FudmFzIHZpZXcnKTtcclxuICAgICAgICAgICAgbGV0IHMgOnN0cmluZ1tdID0gdGhpcy5nZXRBY3RpdmVDaGVja2JveGVzKCk7IC8vIENhbGwgZ2V0QWN0aXZlQ2hlY2tib3hlcyBmdW5jdGlvblxyXG4gICAgICAgICAgICB0aGlzLnNob3dOb2Rlc0J5VGFncyhzKVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG5cclxuICAgIC8vXHUwNDNGXHUwNDQwXHUwNDNFXHUwNDMyXHUwNDM1XHUwNDQwXHUwNDNBXHUwNDMwIFx1MDQzMFx1MDQzQVx1MDQ0Mlx1MDQzOFx1MDQzMlx1MDQzNVx1MDQzRCBcdTA0M0JcdTA0MzggY2FudmFzXHJcbiAgICBwcml2YXRlIGlmQWN0aXZlVmlld0lzQ2FudmFzID0gKGNvbW1hbmRGbjogKGNhbnZhczogYW55LCBjYW52YXNEYXRhOiBDYW52YXNEYXRhKSA9PiB2b2lkKSA9PiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcclxuXHRcdGNvbnN0IGNhbnZhc1ZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XHJcblxyXG5cdFx0aWYgKGNhbnZhc1ZpZXc/LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSB7XHJcblx0XHRcdGlmIChjaGVja2luZykge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGNoZWNraW5nKSB7XHJcblx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGNhbnZhcyA9IChjYW52YXNWaWV3IGFzIGFueSkuY2FudmFzO1xyXG5cdFx0aWYgKCFjYW52YXMpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fTtcclxuXHJcblx0XHRjb25zdCBjYW52YXNEYXRhID0gY2FudmFzLmdldERhdGEoKSBhcyBDYW52YXNEYXRhO1xyXG5cclxuXHRcdGlmICghY2FudmFzRGF0YSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldHVybiBjb21tYW5kRm4oY2FudmFzLCBjYW52YXNEYXRhKTtcclxuXHR9XHJcblxyXG5cclxuICAgIFxyXG5cclxuICAgIGFzeW5jIHNob3dOb2Rlc0J5VGFncyh0YWdzVG9TaG93OiBzdHJpbmdbXSkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuaWZBY3RpdmVWaWV3SXNDYW52YXMoYXN5bmMgKGNhbnZhcywgY2FudmFzRGF0YSkgPT4ge1xyXG5cclxuICAgICAgICAgICAgLy9cdTA0M0VcdTA0NDJcdTA0M0VcdTA0MzFcdTA0NDBcdTA0MzBcdTA0MzZcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDMyXHUwNDQxXHUwNDM1XHUwNDQ1XHJcbiAgICAgICAgICAgIHNob3dPbmx5Tm9kZXMoY2FudmFzLCB0aGlzLnNldHRpbmdzLkhpZGVuT3BhY2l0eSk7XHJcbiAgICAgICAgICAgIHNob3dPbmx5RWRnZXMoY2FudmFzLCB0aGlzLnNldHRpbmdzLkhpZGVuT3BhY2l0eSk7XHJcblxyXG5cclxuICAgICAgICAgICAgLy8gXHUwNDIwXHUwNDM1XHUwNDM2XHUwNDM4XHUwNDNDIDE6IFx1MDQxRlx1MDQ0MFx1MDQzRVx1MDQzMlx1MDQzNVx1MDQ0MFx1MDQ0Rlx1MDQzNVx1MDQ0MiwgXHUwNDQxXHUwNDNFXHUwNDM0XHUwNDM1XHUwNDQwXHUwNDM2XHUwNDM4XHUwNDQyIFx1MDQzQlx1MDQzOCBcdTA0NDJcdTA0MzVcdTA0M0FcdTA0NDNcdTA0NDlcdTA0MzhcdTA0MzkgXHUwNDREXHUwNDNCXHUwNDM1XHUwNDNDXHUwNDM1XHUwNDNEXHUwNDQyIFx1MDQ0NVx1MDQzRVx1MDQ0Mlx1MDQ0RiBcdTA0MzFcdTA0NEIgXHUwNDNFXHUwNDM0XHUwNDM4XHUwNDNEIFx1MDQzOFx1MDQzNyBcdTA0MzJcdTA0NEJcdTA0MzFcdTA0NDBcdTA0MzBcdTA0M0RcdTA0M0RcdTA0NEJcdTA0NDUgXHUwNDQyXHUwNDM1XHUwNDMzXHUwNDNFXHUwNDMyXHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVzVG9TaG93ID0gZmlsdGVyTm9kZXMoY2FudmFzRGF0YSwgdGFnc1RvU2hvdywgIHRoaXMuc2V0dGluZ3MuRmlsdGVyTW9kZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTA0MjBcdTA0MzVcdTA0MzZcdTA0MzhcdTA0M0MgMjogXHUwNDFGXHUwNDQwXHUwNDNFXHUwNDMyXHUwNDM1XHUwNDQwXHUwNDRGXHUwNDM1XHUwNDQyLCBcdTA0NDFcdTA0M0VcdTA0MzRcdTA0MzVcdTA0NDBcdTA0MzZcdTA0MzhcdTA0NDIgXHUwNDNCXHUwNDM4IFx1MDQ0Mlx1MDQzNVx1MDQzQVx1MDQ0MVx1MDQ0MiBcdTA0NDNcdTA0MzdcdTA0M0JcdTA0MzAgXHUwNDEyXHUwNDIxXHUwNDE1IFx1MDQ0Mlx1MDQzNVx1MDQzM1x1MDQzOCBcdTA0MzhcdTA0MzcgXHUwNDQxXHUwNDNGXHUwNDM4XHUwNDQxXHUwNDNBXHUwNDMwXHJcbiAgICAgICAgICAgIC8vY29uc3Qgbm9kZXNUb1Nob3dNb2RlMiA9IGZpbHRlck5vZGVzKGNhbnZhc0RhdGEsIHRhZ3NUb1Nob3csIDIpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGdyb3Vwc1RvU2hvdyA9IGdldEdyb3Vwc0ZvcihjYW52YXNEYXRhLm5vZGVzLCBub2Rlc1RvU2hvdyk7XHJcblxyXG4gICAgXHJcbiAgICAgICAgICAgIGNvbnN0IG5vZGVJZHNUb1Nob3cgPSBuZXcgU2V0KG5vZGVzVG9TaG93Lm1hcCgoeDogYW55KSA9PiB4LmlkKSk7XHJcblxyXG4gICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGVkZ2VzVG9TaG93ID0gZ2V0RWRnZXNXaGVyZUJvdGhOb2Rlc0luU2V0KGNhbnZhc0RhdGEuZWRnZXMsIG5vZGVJZHNUb1Nob3cpO1xyXG4gICAgXHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZ3JvdXAgb2YgZ3JvdXBzVG9TaG93KSB7XHJcbiAgICAgICAgICAgICAgICBub2RlSWRzVG9TaG93LmFkZChncm91cC5pZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICBzaG93T25seU5vZGVzKGNhbnZhcywgdGhpcy5zZXR0aW5ncy5IaWRlbk9wYWNpdHksIG5vZGVJZHNUb1Nob3cpO1xyXG4gICAgICAgICAgICBzaG93T25seUVkZ2VzKGNhbnZhcywgdGhpcy5zZXR0aW5ncy5IaWRlbk9wYWNpdHksIG5ldyBTZXQoZWRnZXNUb1Nob3cubWFwKCh4OiBhbnkpID0+IHguaWQpKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAodGFnc1RvU2hvdy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YWdzIG5vdCBmb3VuZCcpXHJcbiAgICAgICAgICAgICAgICBzaG93T25seU5vZGVzKGNhbnZhcyx0aGlzLnNldHRpbmdzLkhpZGVuT3BhY2l0eSk7XHJcbiAgICAgICAgICAgICAgICBzaG93T25seUVkZ2VzKGNhbnZhcyx0aGlzLnNldHRpbmdzLkhpZGVuT3BhY2l0eSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KShmYWxzZSk7IC8vIFx1MDQxRlx1MDQzNVx1MDQ0MFx1MDQzNVx1MDQzNFx1MDQzMFx1MDQzNVx1MDQzQyBmYWxzZSBcdTA0MzIgY2hlY2tpbmcsIFx1MDQ0Mlx1MDQzMFx1MDQzQSBcdTA0M0FcdTA0MzBcdTA0M0EgXHUwNDNDXHUwNDRCIFx1MDQzRFx1MDQzNSBcdTA0MzJcdTA0NEJcdTA0M0ZcdTA0M0VcdTA0M0JcdTA0M0RcdTA0NEZcdTA0MzVcdTA0M0MgXHUwNDNGXHUwNDQwXHUwNDNFXHUwNDMyXHUwNDM1XHUwNDQwXHUwNDNBXHUwNDQzLCBcdTA0MzAgXHUwNDNGXHUwNDQwXHUwNDRGXHUwNDNDXHUwNDNFIFx1MDQzMlx1MDQ0Qlx1MDQzRlx1MDQzRVx1MDQzQlx1MDQzRFx1MDQ0Rlx1MDQzNVx1MDQzQyBcdTA0M0FcdTA0M0VcdTA0M0NcdTA0MzBcdTA0M0RcdTA0MzRcdTA0NDNcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRBY3RpdmVDaGVja2JveGVzKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCBhY3RpdmVDaGVja2JveGVzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgICAgIGZvciAoY29uc3QgbmFtZSBpbiB0aGlzLnNldHRpbmdzLmNoZWNrYm94U3RhdGVzKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmNoZWNrYm94U3RhdGVzLmhhc093blByb3BlcnR5KG5hbWUpICYmIHRoaXMuc2V0dGluZ3MuY2hlY2tib3hTdGF0ZXNbbmFtZV0pIHtcclxuICAgICAgICAgICAgICAgIGFjdGl2ZUNoZWNrYm94ZXMucHVzaChuYW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWN0aXZlQ2hlY2tib3hlcztcclxuICAgIH1cclxufVxyXG4gICAgLy9cdTA0M0FcdTA0M0JcdTA0MzBcdTA0NDFcdTA0NDEgXHUwNDM4XHUwNDNEXHUwNDQyXHUwNDM1XHUwNDQwXHUwNDQ0XHUwNDM1XHUwNDM5XHUwNDQxXHUwNDMwIFx1MDQzRlx1MDQ0MFx1MDQzOCBcdTA0M0RcdTA0MzBcdTA0MzZcdTA0MzBcdTA0NDJcdTA0MzhcdTA0MzggXHUwNDNEXHUwNDMwIFx1MDQzN1x1MDQzRFx1MDQzMFx1MDQ0N1x1MDQzNVx1MDQzQVxyXG4gICAgY2xhc3MgU2FtcGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICAgICAgY2hlY2tib3hHcm91cHNDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgIHNldHRpbmdzOiBNeVBsdWdpblNldHRpbmdzO1xyXG4gICAgICAgIHNhdmVTZXR0aW5nc0Z1bmM6ICgpID0+IHZvaWQ7XHJcbiAgICAgICAgZ2V0QWN0aXZlQ2hlY2tib3hlc0Z1bmM6ICgpID0+IHN0cmluZ1tdO1xyXG4gICAgICAgIG91dGVyQXBwOiBNeVBsdWdpbjtcclxuXHJcbiAgICBcclxuICAgICAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgc2V0dGluZ3M6IE15UGx1Z2luU2V0dGluZ3MsIHNhdmVTZXR0aW5nc0Z1bmM6ICgpID0+IHZvaWQsIGdldEFjdGl2ZUNoZWNrYm94ZXNGdW5jOiAoKSA9PiBzdHJpbmdbXSwgb3V0ZXJBcHAgOiBNeVBsdWdpbikge1xyXG4gICAgICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzRnVuYyA9IHNhdmVTZXR0aW5nc0Z1bmM7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0QWN0aXZlQ2hlY2tib3hlc0Z1bmMgPSBnZXRBY3RpdmVDaGVja2JveGVzRnVuYztcclxuICAgICAgICAgICAgdGhpcy5vdXRlckFwcD1vdXRlckFwcDtcclxuICAgICAgICB9XHJcblxyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHtjb250ZW50RWx9ID0gdGhpcztcclxuICAgICAgICAvLyBcdTA0MjFcdTA0M0VcdTA0MzdcdTA0MzRcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDNBXHUwNDNFXHUwNDNEXHUwNDQyXHUwNDM1XHUwNDM5XHUwNDNEXHUwNDM1XHUwNDQwIFx1MDQzNFx1MDQzQlx1MDQ0RiBcdTA0MzNcdTA0NDBcdTA0NDNcdTA0M0ZcdTA0M0YgXHUwNDQ3XHUwNDM1XHUwNDNBXHUwNDMxXHUwNDNFXHUwNDNBXHUwNDQxXHUwNDNFXHUwNDMyXHJcbiAgICAgICAgdGhpcy5jaGVja2JveEdyb3Vwc0NvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jyk7XHJcbiAgICAgICAgdGhpcy5jaGVja2JveEdyb3Vwc0NvbnRhaW5lci5hZGRDbGFzcygnY2hlY2tib3gtZ3JvdXBzLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIC8vdGhpcy5yZWZyZXNoQ2hlY2tib3hHcm91cHMoKVxyXG5cclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy9cdTA0NDFcdTA0M0VcdTA0MzdcdTA0MzRcdTA0MzBcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDQyXHUwNDM1XHUwNDNBXHUwNDQxXHUwNDQyXHUwNDNFXHUwNDMyXHUwNDNFXHUwNDMzXHUwNDNFIFx1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0RiBcdTA0MzRcdTA0M0JcdTA0NEYgXHUwNDMyXHUwNDMyXHUwNDNFXHUwNDM0XHUwNDMwIGpzb24gLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgIGNvbnN0IGpzb25JbnB1dENvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVFbCgnZGl2Jyk7XHJcbiAgICAgICAganNvbklucHV0Q29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICc1MHB4JztcclxuICAgICAgICBqc29uSW5wdXRDb250YWluZXIuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiBcIkpzb24gc3RydWN0dXJlXCJ9KTtcclxuICAgICAgICBqc29uSW5wdXRDb250YWluZXIuYWRkQ2xhc3MoJ2pzb24taW5wdXQtY29udGFpbmVyJyk7XHJcbiAgICAgICAgY29uc3QganNvbklucHV0ID0ganNvbklucHV0Q29udGFpbmVyLmNyZWF0ZUVsKCd0ZXh0YXJlYScsIHsgYXR0cjogeyByb3dzOiBcIjFcIiB9IH0pIGFzIEhUTUxUZXh0QXJlYUVsZW1lbnQ7XHJcbiAgICAgICAganNvbklucHV0LnZhbHVlID0gdGhpcy5zZXR0aW5ncy5qc29uSW5wdXQ7XHJcbiAgICAgICAganNvbklucHV0LnBsYWNlaG9sZGVyID0gXCJFbnRlciBKU09OIGZvciBjaGVja2JveCBncm91cHNcIjtcclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1x1MDQxNFx1MDQzRVx1MDQzMVx1MDQzMFx1MDQzMlx1MDQzQlx1MDQ0Rlx1MDQzNVx1MDQzQyBcdTA0M0FcdTA0M0RcdTA0M0VcdTA0M0ZcdTA0M0FcdTA0NDMgXHUwNDM0XHUwNDNCXHUwNDRGIFx1MDQ0MVx1MDQzRVx1MDQ0NVx1MDQ0MFx1MDQzMFx1MDQzRFx1MDQzNVx1MDQzRFx1MDQzOFx1MDQ0RiBKU09OLy8vLy8vLy8vLy8vLy8vL1xyXG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBjb250ZW50RWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIHNhdmVCdXR0b24uYWRkQ2xhc3MoJ21vZC1jdGEnKTtcclxuICAgICAgICBzYXZlQnV0dG9uLnNldFRleHQoJ1JlZnJlc2ggZ3JvdXBzJyk7XHJcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgLy9cdTA0NDNcdTA0MzRcdTA0MzBcdTA0M0JcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDQxXHUwNDQyXHUwNDMwXHUwNDQwXHUwNDNFXHUwNDMzXHUwNDNFIFx1MDQzNFx1MDQzQlx1MDQ0RiBcdTA0NDFcdTA0M0VcdTA0MzdcdTA0MzRcdTA0MzBcdTA0M0RcdTA0MzhcdTA0NEYgXHUwNDNEXHUwNDNFXHUwNDMyXHUwNDNFXHUwNDMzXHUwNDNFXHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrYm94R3JvdXBzQ29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QganNvbkRhdGEgPSBKU09OLnBhcnNlKGpzb25JbnB1dC52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmNoZWNrYm94R3JvdXBzID0ganNvbkRhdGE7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmpzb25JbnB1dCA9IGpzb25JbnB1dC52YWx1ZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzRnVuYygpO1xyXG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnSlNPTiBzYXZlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTQVZFJylcclxuICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaENoZWNrYm94R3JvdXBzKCk7XHJcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBwYXJzaW5nIEpTT04nKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5cclxuXHJcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1x1MDQzNFx1MDQzRVx1MDQzMVx1MDQzMFx1MDQzMlx1MDQzQlx1MDQzNVx1MDQzRFx1MDQzOFx1MDQzNSBcdTA0M0FcdTA0M0RcdTA0M0VcdTA0M0ZcdTA0M0FcdTA0MzggXHUwNDQxXHUwNDMxXHUwNDQwXHUwNDNFXHUwNDQxXHUwNDMwLy8vLy8vLy8vLy8vLy8vLy8vXHJcbiAgICAgICAgY29uc3QgcmVzZXRCdXR0b24gPSBjb250ZW50RWwuY3JlYXRlRWwoJ2J1dHRvbicpO1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLmFkZENsYXNzKCdtb2QtY3RhJyk7XHJcbiAgICAgICAgcmVzZXRCdXR0b24uc2V0VGV4dCgnUmVzZXQnKTtcclxuICAgICAgICByZXNldEJ1dHRvbi5zdHlsZS5wb3NpdGlvbiA9ICdhYnNvbHV0ZSc7XHJcbiAgICAgICAgcmVzZXRCdXR0b24uc3R5bGUuYm90dG9tID0gJzEwcHgnOyAvLyBcdTA0NDBcdTA0MzBcdTA0NDFcdTA0NDFcdTA0NDJcdTA0M0VcdTA0NEZcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDNFXHUwNDQyIFx1MDQzRFx1MDQzOFx1MDQzNlx1MDQzRFx1MDQzNVx1MDQzOSBcdTA0MzNcdTA0NDBcdTA0MzBcdTA0M0RcdTA0MzhcdTA0NDZcdTA0NEJcclxuICAgICAgICByZXNldEJ1dHRvbi5zdHlsZS5yaWdodCA9ICcxMHB4JzsgLy8gXHUwNDQwXHUwNDMwXHUwNDQxXHUwNDQxXHUwNDQyXHUwNDNFXHUwNDRGXHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQzRVx1MDQ0MiBcdTA0M0ZcdTA0NDBcdTA0MzBcdTA0MzJcdTA0M0VcdTA0MzkgXHUwNDMzXHUwNDQwXHUwNDMwXHUwNDNEXHUwNDM4XHUwNDQ2XHUwNDRCXHJcbiAgICAgICAgcmVzZXRCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JlZCc7IC8vIFx1MDQzQVx1MDQ0MFx1MDQzMFx1MDQ0MVx1MDQzRFx1MDQ0Qlx1MDQzOSBcdTA0NDZcdTA0MzJcdTA0MzVcdTA0NDJcclxuICAgICAgICByZXNldEJ1dHRvbi5zdHlsZS50cmFuc2l0aW9uID0gJ2JhY2tncm91bmQtY29sb3IgMC4zcyBlYXNlJzsgLy8gXHUwNDMwXHUwNDNEXHUwNDM4XHUwNDNDXHUwNDMwXHUwNDQ2XHUwNDM4XHUwNDRGIFx1MDQzRlx1MDQzNVx1MDQ0MFx1MDQzNVx1MDQ0NVx1MDQzRVx1MDQzNFx1MDQzMCBcdTA0NDZcdTA0MzJcdTA0MzVcdTA0NDJcdTA0MzBcclxuICAgICAgICAvLyBcdTA0MUZcdTA0NDBcdTA0MzggXHUwNDNEXHUwNDMwXHUwNDMyXHUwNDM1XHUwNDM0XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM4IFx1MDQzQVx1MDQzRFx1MDQzRVx1MDQzRlx1MDQzQVx1MDQzMCBcdTA0NDFcdTA0NDJcdTA0MzBcdTA0M0RcdTA0M0VcdTA0MzJcdTA0MzhcdTA0NDJcdTA0NDFcdTA0NEYgXHUwNDQ3XHUwNDQzXHUwNDQyXHUwNDRDIFx1MDQzMVx1MDQzNVx1MDQzQlx1MDQzNVx1MDQzNVxyXG4gICAgICAgIHJlc2V0QnV0dG9uLm9ubW91c2VlbnRlciA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmVzZXRCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJyNmZjY2NjYnOyAvLyBcdTA0MzFcdTA0M0VcdTA0M0JcdTA0MzVcdTA0MzUgXHUwNDQxXHUwNDMyXHUwNDM1XHUwNDQyXHUwNDNCXHUwNDMwXHUwNDRGIFx1MDQzQVx1MDQ0MFx1MDQzMFx1MDQ0MVx1MDQzRFx1MDQzMFx1MDQ0RlxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8vIFx1MDQxRlx1MDQ0MFx1MDQzOCBcdTA0NDNcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzUgXHUwNDNBXHUwNDQzXHUwNDQwXHUwNDQxXHUwNDNFXHUwNDQwXHUwNDMwIFx1MDQ0MSBcdTA0M0FcdTA0M0RcdTA0M0VcdTA0M0ZcdTA0M0FcdTA0MzgsIFx1MDQ0Nlx1MDQzMlx1MDQzNVx1MDQ0MiBcdTA0MzJcdTA0M0VcdTA0MzdcdTA0MzJcdTA0NDBcdTA0MzBcdTA0NDlcdTA0MzBcdTA0MzVcdTA0NDJcdTA0NDFcdTA0NEYgXHUwNDNBIFx1MDQzRVx1MDQzMVx1MDQ0Qlx1MDQ0N1x1MDQzRFx1MDQzRVx1MDQzQ1x1MDQ0M1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLm9ubW91c2VsZWF2ZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgcmVzZXRCdXR0b24uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ3JlZCc7IC8vIFx1MDQzRVx1MDQzMVx1MDQ0Qlx1MDQ0N1x1MDQzRFx1MDQzMFx1MDQ0RiBcdTA0M0FcdTA0NDBcdTA0MzBcdTA0NDFcdTA0M0RcdTA0MzBcdTA0NEZcclxuICAgICAgICB9O1xyXG4gICAgICAgIHJlc2V0QnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY2hlY2tib3hTdGF0ZXM9e307XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTA0MUZcdTA0M0VcdTA0M0JcdTA0NDNcdTA0NDdcdTA0MzBcdTA0MzVcdTA0M0MgXHUwNDMyXHUwNDQxXHUwNDM1IFx1MDQ0N1x1MDQzNVx1MDQzQVx1MDQzMVx1MDQzRVx1MDQzQVx1MDQ0MVx1MDQ0QiBcdTA0M0RcdTA0MzAgXHUwNDQxXHUwNDQyXHUwNDQwXHUwNDMwXHUwNDNEXHUwNDM4XHUwNDQ2XHUwNDM1XHJcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrYm94ZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1MDQxRlx1MDQ0MFx1MDQzRVx1MDQ0NVx1MDQzRVx1MDQzNFx1MDQzOFx1MDQzQ1x1MDQ0MVx1MDQ0RiBcdTA0M0ZcdTA0M0UgXHUwNDNBXHUwNDMwXHUwNDM2XHUwNDM0XHUwNDNFXHUwNDNDXHUwNDQzIFx1MDQ0N1x1MDQzNVx1MDQzQVx1MDQzMVx1MDQzRVx1MDQzQVx1MDQ0MVx1MDQ0MyBcdTA0MzggXHUwNDQxXHUwNDNEXHUwNDM4XHUwNDNDXHUwNDMwXHUwNDM1XHUwNDNDIFx1MDQ0NFx1MDQzQlx1MDQzMFx1MDQzNlx1MDQzRVx1MDQzQVxyXG4gICAgICAgICAgICBjaGVja2JveGVzLmZvckVhY2goKGNoZWNrYm94KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoY2hlY2tib3ggaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTsvKlxyXG5cclxuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5zZXR0aW5ncy5jaGVja2JveFN0YXRlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuY2hlY2tib3hTdGF0ZXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY2hlY2tib3hTdGF0ZXNba2V5XSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9Ki9cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQocmVzZXRCdXR0b24pOyAvLyBcdTA0MzRcdTA0M0VcdTA0MzFcdTA0MzBcdTA0MzJcdTA0M0JcdTA0NEZcdTA0MzVcdTA0M0MgXHUwNDNBXHUwNDNEXHUwNDNFXHUwNDNGXHUwNDNBXHUwNDQzIFx1MDQzMiBcdTA0M0FcdTA0M0VcdTA0M0RcdTA0NDJcdTA0MzVcdTA0MzlcdTA0M0RcdTA0MzVcdTA0NDAqL1xyXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaENoZWNrYm94R3JvdXBzKClcclxuXHJcbiAgICB9XHJcblxyXG4gICAgLy9cdTA0M0ZcdTA0MzVcdTA0NDBcdTA0MzVcdTA0M0VcdTA0NDJcdTA0NDBcdTA0MzhcdTA0NDFcdTA0M0VcdTA0MzJcdTA0M0FcdTA0MzAgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGIFx1MDQ0MSBcdTA0NDdcdTA0MzVcdTA0M0FcdTA0MzFcdTA0M0VcdTA0M0FcdTA0NDFcdTA0MzBcdTA0M0NcdTA0MzhcclxuICAgIHJlZnJlc2hDaGVja2JveEdyb3VwcygpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY2hlY2tib3hHcm91cHNDb250YWluZXIpIHJldHVybjtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy9cdTA0MzRcdTA0M0VcdTA0MzFcdTA0MzBcdTA0MzJcdTA0M0JcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDMzXHUwNDQwXHUwNDQzXHUwNDNGXHUwNDNGXHUwNDRCIFx1MDQzRFx1MDQzNVx1MDQzRFx1MDQzMFx1MDQzOVx1MDQzNFx1MDQzNVx1MDQzRFx1MDQzRFx1MDQ0Qlx1MDQ0NSBcdTA0NDJcdTA0MzVcdTA0MzNcdTA0M0VcdTA0MzJcclxuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5hZGRPdGhlclRhZ3NHcm91cCl7XHJcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coYWRkVW5kZWZpbmVkR3JvdXAodGhpcy5zZXR0aW5ncy5jaGVja2JveEdyb3VwcywgdGhpcy5nZXRVbmlxdWVUYWdzKCkgKSlcclxuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5jaGVja2JveEdyb3Vwcz1hZGRVbmRlZmluZWRHcm91cCh0aGlzLnNldHRpbmdzLmNoZWNrYm94R3JvdXBzLCB0aGlzLmdldFVuaXF1ZVRhZ3MoKSlcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7IFxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5jaGVja2JveEdyb3Vwcy5oYXNPd25Qcm9wZXJ0eShcIk90aGVyIHRhZ3NcIikpIHtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSB0aGlzLnNldHRpbmdzLmNoZWNrYm94R3JvdXBzW1wiT3RoZXIgdGFnc1wiXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vXHUwNDFFXHUwNDQyXHUwNDNFXHUwNDMxXHUwNDQwXHUwNDMwXHUwNDM2XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQzM1x1MDQ0MFx1MDQ0M1x1MDQzRlx1MDQzRiBcdTA0NDEgXHUwNDQyXHUwNDM1XHUwNDMzXHUwNDMwXHUwNDNDXHUwNDM4XHJcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5zZXR0aW5ncy5jaGVja2JveEdyb3VwcykuZm9yRWFjaChncm91cE5hbWUgPT4ge1xyXG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGAke2dyb3VwTmFtZX06YCwgdGhpcy5zZXR0aW5ncy5jaGVja2JveEdyb3Vwc1tncm91cE5hbWVdKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IGdyb3VwQ29udGFpbmVyID0gdGhpcy5jaGVja2JveEdyb3Vwc0NvbnRhaW5lci5jcmVhdGVFbCgnZGl2Jyk7XHJcbiAgICAgICAgICAgIGdyb3VwQ29udGFpbmVyLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogZ3JvdXBOYW1lIH0pO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY2hlY2tib3hHcm91cHNbZ3JvdXBOYW1lXS5mb3JFYWNoKHRhZyA9PiB0aGlzLmNyZWF0ZUNoZWNrYm94KGdyb3VwQ29udGFpbmVyLCB0YWcpKTtcclxuICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuXHJcbiAgICB9XHJcblxyXG4gICAgY3JlYXRlQ2hlY2tib3goY29udGFpbmVyOiBIVE1MRWxlbWVudCwgbmFtZTogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgY2hlY2tib3ggPSBjb250YWluZXIuY3JlYXRlRWwoJ2xhYmVsJyk7XHJcbiAgICAgICAgY2hlY2tib3guc2V0VGV4dChuYW1lKTtcclxuICAgICAgICBjb25zdCBjaGVja2JveElucHV0ID0gY2hlY2tib3guY3JlYXRlRWwoJ2lucHV0Jyk7XHJcbiAgICAgICAgY2hlY2tib3hJbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnY2hlY2tib3gnKTtcclxuICAgICAgICBjaGVja2JveElucHV0LmNoZWNrZWQgPSB0aGlzLnNldHRpbmdzLmNoZWNrYm94U3RhdGVzW25hbWVdID8/IGZhbHNlOyAvLyBTZXQgY2hlY2tib3ggc3RhdGUgZnJvbSBzZXR0aW5nc1xyXG4gICAgICAgIGNoZWNrYm94SW5wdXQub25jaGFuZ2UgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuY2hlY2tib3hTdGF0ZXNbbmFtZV0gPSBjaGVja2JveElucHV0LmNoZWNrZWQ7XHJcbiAgICAgICAgICAgIHRoaXMuc2F2ZVNldHRpbmdzRnVuYygpOyAvLyBTYXZlIHNldHRpbmdzXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3Qge2NvbnRlbnRFbH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cclxuXHJcbiAgICAgICAgbGV0IHMgOnN0cmluZ1tdID0gdGhpcy5nZXRBY3RpdmVDaGVja2JveGVzRnVuYygpOyAvLyBDYWxsIGdldEFjdGl2ZUNoZWNrYm94ZXMgZnVuY3Rpb25cclxuICAgICAgICB0aGlzLm91dGVyQXBwLnNob3dOb2Rlc0J5VGFncyhzKVxyXG4gICAgICAgIC8vdGhpcy5zaG93Tm9kZXNCeVRhZ3MocylcclxuICAgIH1cclxuXHJcbiAgICAvL1x1MDQzRlx1MDQzRVx1MDQzQlx1MDQ0M1x1MDQ0N1x1MDQzNVx1MDQzRFx1MDQzOFx1MDQzNSBcdTA0NDNcdTA0M0RcdTA0MzhcdTA0M0FcdTA0MzBcdTA0M0JcdTA0NENcdTA0M0RcdTA0NEJcdTA0NDUgXHUwNDQyXHUwNDREXHUwNDMzXHUwNDNFXHUwNDMyIFxyXG4gICAgZ2V0VW5pcXVlVGFncygpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCB1bmlxdWUgdGFncyBmcm9tIG5vZGVzIG9uIGNhbnZhc1xyXG4gICAgICAgIGNvbnN0IGNhbnZhc1ZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShJdGVtVmlldyk7XHJcbiAgICAgICAgaWYgKGNhbnZhc1ZpZXc/LmdldFZpZXdUeXBlKCkgIT09ICdjYW52YXMnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBjb25zdCBjYW52YXNEYXRhID0gKGNhbnZhc1ZpZXcgYXMgYW55KS5jYW52YXMuZ2V0RGF0YSgpIGFzIENhbnZhc0RhdGE7XHJcbiAgICAgICAgaWYgKCFjYW52YXNEYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbXTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICBjb25zdCB0YWdzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICAgICAgICBjYW52YXNEYXRhLm5vZGVzLmZvckVhY2goKG5vZGU6IGFueSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAobm9kZS50eXBlID09PSBcInRleHRcIikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGV4dFRhZ3MgPSBub2RlLnRleHQubWF0Y2goLyNbXlxcc10rL2cpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRleHRUYWdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dFRhZ3MuZm9yRWFjaCgodGFnOiBzdHJpbmcpID0+IHRhZ3MuYWRkKHRhZykpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5vZGUudHlwZSA9PT0gXCJmaWxlXCIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1ldGFkYXRhID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZShub2RlLmZpbGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhICYmIG1ldGFkYXRhLnRhZ3MpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YS50YWdzLmZvckVhY2goKHRhZzogeyB0YWc6IHN0cmluZyB9KSA9PiB0YWdzLmFkZCh0YWcudGFnKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgIC8vIFx1MDQxRlx1MDQ0MFx1MDQzNVx1MDQzRVx1MDQzMVx1MDQ0MFx1MDQzMFx1MDQzN1x1MDQ0M1x1MDQzNVx1MDQzQyBzZXQgXHUwNDMyIFx1MDQzQ1x1MDQzMFx1MDQ0MVx1MDQ0MVx1MDQzOFx1MDQzMiBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0M0EgXHUwNDM4IFx1MDQzMlx1MDQzRVx1MDQzN1x1MDQzMlx1MDQ0MFx1MDQzMFx1MDQ0OVx1MDQzMFx1MDQzNVx1MDQzQyBcdTA0MzVcdTA0MzNcdTA0M0VcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0YWdzKTtcclxuICAgIH1cclxuICAgIFxyXG59XHJcblxyXG4vL1x1MDQzQVx1MDQzQlx1MDQzMFx1MDQ0MVx1MDQ0MSBcdTA0M0RcdTA0MzBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0MzVcdTA0M0FcclxuY2xhc3MgU2FtcGxlU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBNeVBsdWdpbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNeVBsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHtjb250YWluZXJFbH0gPSB0aGlzO1xyXG5cclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ0FkZCBcIk90aGVyIHRhZ3NcIiBncm91cCcpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdDaGVjayB0aGlzIGJveCB0byBhZGQgYW4gXCJPdGhlciB0YWdzXCIgZ3JvdXAuJylcclxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuYWRkT3RoZXJUYWdzR3JvdXApIC8vIFx1MDQyM1x1MDQ0MVx1MDQ0Mlx1MDQzMFx1MDQzRFx1MDQzMFx1MDQzMlx1MDQzQlx1MDQzOFx1MDQzMlx1MDQzMFx1MDQzNVx1MDQzQyBcdTA0MzdcdTA0M0RcdTA0MzBcdTA0NDdcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDQ3XHUwNDM1XHUwNDNBXHUwNDMxXHUwNDNFXHUwNDNBXHUwNDQxXHUwNDMwIFx1MDQzOFx1MDQzNyBcdTA0M0RcdTA0MzBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0MzVcdTA0M0FcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hZGRPdGhlclRhZ3NHcm91cCA9IHZhbHVlOyAvLyBcdTA0MjFcdTA0M0VcdTA0NDVcdTA0NDBcdTA0MzBcdTA0M0RcdTA0NEZcdTA0MzVcdTA0M0MgXHUwNDM3XHUwNDNEXHUwNDMwXHUwNDQ3XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQ0N1x1MDQzNVx1MDQzQVx1MDQzMVx1MDQzRVx1MDQzQVx1MDQ0MVx1MDQzMCBcdTA0MzIgXHUwNDNEXHUwNDMwXHUwNDQxXHUwNDQyXHUwNDQwXHUwNDNFXHUwNDM5XHUwNDNBXHUwNDM4XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdIaWRkZW4gT3BhY2l0eScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdBZGp1c3QgdGhlIG9wYWNpdHkgbGV2ZWwgZm9yIGhpZGRlbiBlbGVtZW50cy4gVmFsdWUgbXVzdCBiZWVuIGJldHdlZW4gMCBhbmQgMScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLkhpZGVuT3BhY2l0eSkgLy8gXHUwNDIzXHUwNDQxXHUwNDQyXHUwNDMwXHUwNDNEXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDM4XHUwNDMyXHUwNDMwXHUwNDM1XHUwNDNDIFx1MDQzN1x1MDQzRFx1MDQzMFx1MDQ0N1x1MDQzNVx1MDQzRFx1MDQzOFx1MDQzNSBcdTA0NDJcdTA0MzVcdTA0M0FcdTA0NDFcdTA0NDJcdTA0M0VcdTA0MzJcdTA0M0VcdTA0MzNcdTA0M0UgXHUwNDNGXHUwNDNFXHUwNDNCXHUwNDRGIFx1MDQzOFx1MDQzNyBcdTA0M0RcdTA0MzBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0MzVcdTA0M0FcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJzZWRWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1MDQyM1x1MDQzMVx1MDQzNVx1MDQzNlx1MDQzNFx1MDQzMFx1MDQzNVx1MDQzQ1x1MDQ0MVx1MDQ0RiwgXHUwNDQ3XHUwNDQyXHUwNDNFIFx1MDQzN1x1MDQzRFx1MDQzMFx1MDQ0N1x1MDQzNVx1MDQzRFx1MDQzOFx1MDQzNSBcdTA0M0RcdTA0MzBcdTA0NDVcdTA0M0VcdTA0MzRcdTA0MzhcdTA0NDJcdTA0NDFcdTA0NEYgXHUwNDMyIFx1MDQzNFx1MDQzOFx1MDQzMFx1MDQzRlx1MDQzMFx1MDQzN1x1MDQzRVx1MDQzRFx1MDQzNSBcdTA0M0VcdTA0NDIgMCBcdTA0MzRcdTA0M0UgMVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gTWF0aC5tYXgoMCwgTWF0aC5taW4ocGFyc2VkVmFsdWUsIDEpKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5IaWRlbk9wYWNpdHkgPSBuZXdWYWx1ZS50b1N0cmluZygpOyAvLyBcdTA0MjFcdTA0M0VcdTA0NDVcdTA0NDBcdTA0MzBcdTA0M0RcdTA0NEZcdTA0MzVcdTA0M0MgXHUwNDM3XHUwNDNEXHUwNDMwXHUwNDQ3XHUwNDM1XHUwNDNEXHUwNDM4XHUwNDM1IFx1MDQzMiBcdTA0M0RcdTA0MzBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0MzlcdTA0M0FcdTA0MzggXHUwNDMyIFx1MDQzMlx1MDQzOFx1MDQzNFx1MDQzNSBcdTA0NDFcdTA0NDJcdTA0NDBcdTA0M0VcdTA0M0FcdTA0MzhcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ2JldHdlZW4gMCBhbmQgMScpXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdGaWx0ZXIgbW9kZScpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdcIkFueSBUYWcgSW5jbHVzaW9uXCIgbWVhbnMgdGhhdCBub2RlcyB3aWxsIGJlIHNob3duIGlmIHRoZXkgY29udGFpbiBhdCBsZWFzdCBvbmUgb2YgdGhlIHNlbGVjdGVkIHRhZ3MuIFwiQWxsIFRhZ3MgSW5jbHVzaW9uXCIgbWVhbnMgdGhhdCBub2RlcyB3aWxsIG9ubHkgYmUgc2hvd24gaWYgdGhleSBjb250YWluIGFsbCBvZiB0aGUgc2VsZWN0ZWQgdGFncy4nKVxyXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oZHJvcGRvd24gPT4gZHJvcGRvd25cclxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oXCJBbGwgVGFncyBJbmNsdXNpb25cIiwgXCJBbGwgVGFncyBJbmNsdXNpb25cIikgLy8gXHUwNDE0XHUwNDNFXHUwNDMxXHUwNDMwXHUwNDMyXHUwNDNCXHUwNDRGXHUwNDM1XHUwNDNDIFx1MDQzQVx1MDQzMFx1MDQzNlx1MDQzNFx1MDQ0Qlx1MDQzOSBcdTA0MzJcdTA0MzBcdTA0NDBcdTA0MzhcdTA0MzBcdTA0M0RcdTA0NDIgXHUwNDNFXHUwNDQyXHUwNDM0XHUwNDM1XHUwNDNCXHUwNDRDXHUwNDNEXHUwNDNFXHJcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKFwiQW55IFRhZyBJbmNsdXNpb25cIiwgXCJBbnkgVGFnIEluY2x1c2lvblwiKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLkZpbHRlck1vZGUpIC8vIFx1MDQyM1x1MDQ0MVx1MDQ0Mlx1MDQzMFx1MDQzRFx1MDQzMFx1MDQzMlx1MDQzQlx1MDQzOFx1MDQzMlx1MDQzMFx1MDQzNVx1MDQzQyBcdTA0MzdcdTA0M0RcdTA0MzBcdTA0NDdcdTA0MzVcdTA0M0RcdTA0MzhcdTA0MzUgXHUwNDM4XHUwNDM3IFx1MDQzRFx1MDQzMFx1MDQ0MVx1MDQ0Mlx1MDQ0MFx1MDQzRVx1MDQzNVx1MDQzQVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLkZpbHRlck1vZGUgPSB2YWx1ZTsgLy8gXHUwNDIxXHUwNDNFXHUwNDQ1XHUwNDQwXHUwNDMwXHUwNDNEXHUwNDRGXHUwNDM1XHUwNDNDIFx1MDQzN1x1MDQzRFx1MDQzMFx1MDQ0N1x1MDQzNVx1MDQzRFx1MDQzOFx1MDQzNSBcdTA0MzIgXHUwNDNEXHUwNDMwXHUwNDQxXHUwNDQyXHUwNDQwXHUwNDNFXHUwNDM5XHUwNDNBXHUwNDM4XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQSxzQkFBK0c7QUFRL0csMkJBQTJCLE1BQStDO0FBQ3pFLFNBQVEsOEJBQWMsVUFBUztBQUNoQztBQUVBLGdDQUFnQyxXQUEyQixXQUEyQjtBQUNyRixTQUFPLFVBQVUsS0FBSyxVQUFVLEtBQzNCLFVBQVUsSUFBSSxVQUFVLFNBQVcsVUFBVSxJQUFJLFVBQVUsU0FDNUQsVUFBVSxLQUFLLFVBQVUsS0FDeEIsVUFBVSxJQUFJLFVBQVUsVUFBWSxVQUFVLElBQUksVUFBVTtBQUNsRTtBQUVBLHVCQUF1QixRQUFhLFNBQWlCLFdBQXlCO0FBQzFFLFFBQU0sUUFBUSxPQUFPLE1BQU0sT0FBTztBQUVsQyxhQUFXLFFBQVEsT0FBTztBQUN0QixRQUFJLGNBQWMsVUFBYSxVQUFVLElBQUksS0FBSyxF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
